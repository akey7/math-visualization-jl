---
title: "Julia: Strogatz Chapter 06 Examples"
author: "Alicia"
date: "2025-05-02"
categories: [julia, math]
format:
  html:
    toc: true
    html-math-method: mathjax
    code-fold: false
engine: julia
freeze: false
---

The following Julia packages will be needed for this document:

```{julia}
#| label: using-things
#| include: true
#| echo: true
#| eval: true

using NonlinearSolve
using DifferentialEquations
using SciMLBase
using StaticArrays
using ForwardDiff
using LinearAlgebra
using PlotlyJS
```

> In the document below, many code cells have an extra `;` after the code to suppress junk from being output into this document.

## Phase Portrait Analysis and Plotting Functions

### Fixed Points

There might be multiple fixed points for a given phase portrait, and the following function finds fixed points within a given region with `NonlinearSolve`.

```{julia}
#| label: fixed-point-finder
#| include: true
#| echo: true
#| eval: true

function find_fixed_points(system_of_eqs; guess_xs::AbstractRange, guess_ys::AbstractRange)
    fixed_points = []
    for (guess_x, guess_y) ∈ Base.product(guess_xs, guess_ys)
        u0 = SA[guess_x, guess_y]
        prob = NonlinearProblem(system_of_eqs, u0)
        sol = solve(prob, NewtonRaphson())
        if SciMLBase.successful_retcode(sol)
            found = false
            for fixed_point ∈ fixed_points
                if isapprox(fixed_point[1], sol.u[1], atol = 1e-3) &&
                   isapprox(fixed_point[2], sol.u[2], atol = 1e-3)
                    found = true
                    break
                end
            end
            if !found
                push!(fixed_points, sol.u)
            end
        end
    end
    return fixed_points
end;
```

### Find Jacobians at Fixed Points

The following function finds the Jacobians for the given system of equations and fixed points.

```{julia}
#| label: jacobian-finder
#| include: true
#| echo: true
#| eval: true

function find_jacobians(system_of_eqs, fps)
    jacobians = []
    for fp ∈ fps
        jacobian = ForwardDiff.jacobian(system_of_eqs, fp)
        push!(jacobians, jacobian)
    end
    return jacobians
end;
```


### Classify Fixed Points

This function classifies a fixed point depending trace and determinant of the Jacobian at that fixed point.

```{julia}
#| label: jacobian-classifier
#| include: true
#| echo: true
#| eval: true

function classify_jacobian(A::Matrix{Float64})
    τ = tr(A)
    Δ = det(A)
    discriminant = tr(A)^2 - 4*det(A)
    if Δ < 0.0
        return "Saddle"
    else
        if isapprox(discriminant, 0.0)
            return "Star, Degenerate"
        elseif discriminant > 0.0
            if isapprox(τ, 0.0)
                return "Neutral Stable"
            elseif τ < 0.0
                return "Stable"
            else
                return "Unstable"
            end
        else
            return "Spiral"
        end
    end
    return "Unknown"
end;
```

### Slope Field Calculation

This function calculates the slope field defined by *f* and *g* over the points defined by `xs` and `ys`.

```{julia}
#| label: slope-field-function
#| include: true
#| echo: true
#| eval: true

function slope_field(xs, ys)
    scaler = 1 / length(xs)
    start_xys = Base.product(xs, ys)
    end_xys = [
        (start_xy[1] + f(start_xy)*scaler, start_xy[2] + g(start_xy)*scaler) for
        start_xy ∈ start_xys
    ]
    return start_xys, end_xys
end;
```
